---
globs:
  - .beads/issues.jsonl
  - .beads/*.jsonl
---

# STOP - Do NOT Edit This File Directly

**NEVER** edit `.beads/issues.jsonl` or any `.beads/*.jsonl` file directly.

## Why This Rule Exists

**The database is the source of truth, NOT the JSONL file.** The `.beads/issues.jsonl` is merely an export/snapshot.

Direct edits to the JSONL file:
- **Are NOT reflected in the database** - the bd CLI reads from the database, not JSONL
- **Will be overwritten** - running `bd sync` exports the database to JSONL, losing your edits
- **Cannot be imported cleanly** - `bd import` fails with duplicate key errors if issues already exist
- **Bypass validation** - no schema validation, required field checks, or relationship integrity
- **Break parent-child relationships** - auto-generated IDs won't follow the correct numbering scheme
- **Corrupt audit trails** - no `created_by`, `updated_at`, or actor tracking

### Discovered Limitations

1. **bd sync overwrites JSONL**: The sync command exports DB → JSONL, not the reverse
2. **bd import conflicts**: Cannot update existing issues via import without complex merge handling
3. **ID generation**: The bd CLI auto-generates IDs like `projx-695.21`; manual IDs like `projx-695.aa1` are non-standard
4. **Status tracking**: Direct edits bypass the status change audit trail

## What You MUST Do Instead

**ALWAYS use the `bd` CLI** for all beads operations:

```bash
# List issues
bd list
bd list --status open
bd list --type epic

# Show issue details
bd show <issue-id>

# Create issues
bd create --title "Issue title" --type task
bd create --title "Epic title" --type epic --priority 1

# Update issues
bd update <issue-id> --status in_progress
bd update <issue-id> --priority 2
bd update <issue-id> --assignee "username"

# Close/reopen issues
bd close <issue-id>
bd reopen <issue-id>

# Add dependencies
bd update <issue-id> --blocked-by <other-id>
```

## Prohibited Actions

- ❌ `cat >> .beads/issues.jsonl`
- ❌ `echo '...' >> .beads/issues.jsonl`
- ❌ Using the `Write` tool on `.beads/*.jsonl`
- ❌ Using the `Edit` tool on `.beads/*.jsonl`
- ❌ Using `sed`, `awk`, or any text manipulation on `.beads/*.jsonl`
- ❌ Any direct file modification whatsoever

## If You Need to Query Issues

For read-only queries, you may use:

```bash
# Safe read-only operations
just db status        # View issue counts
just db query '.[]'   # Query with jq
just db browse        # Interactive browser (fzf)
bd list --json        # JSON output for parsing
```

## Enforcement

This rule is **strictly enforced**. Any attempt to directly modify beads files will be rejected.
